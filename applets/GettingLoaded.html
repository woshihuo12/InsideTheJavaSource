<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
"http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>
<TITLE>Inside J2VM Interactive Illustrations - Getting Loaded</TITLE>
<META NAME="description" content="Getting Loaded (Java applet) - Stepping
through a Java class file.">
<META NAME="keywords" content="Java Virtual Machine, Java Class File, class
file format">
<META NAME="author" content="Bill Venners">
</HEAD>
<!--BEGIN_ARTIMA_COLOR_SCHEME-->
<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#000099" VLINK="#009999" ALINK="#CC0000">
<!--END_ARTIMA_COLOR_SCHEME-->
<!--BEGIN_FISH_HEADING--> 
<CENTER>
<IMG src="images/fishhead.gif" alt="Interactive Illustrations for Inside the
Java 2 Virtual Machine">
</CENTER>
<!--END_FISH_HEADING--> 
<!--BEGIN_MAIN_TITLES-->
<FONT face="arial, helvetica" COLOR="#000066">
<FONT size=6>Getting Loaded</FONT><BR>
<FONT size=3>Stepping Through a Class File</FONT><BR>
</FONT>
<!--END_MAIN_TITLES-->
<!--BEGIN_TITLE_UNDERBAR-->
<HR align="left" width="85%">
<!--END_TITLE_UNDERBAR-->
<!--BEGIN_RIGHT_MARGIN_TABLE_TAG-->
<TABLE CELLPADDING="3" CELLSPACING="0" BORDER="0" width="85%">
<TR>
<TD  valign="top" rowspan="100">
<!--END_RIGHT_MARGIN_TABLE_TAG-->
<!--BEGIN_MAIN_BODY-->
<!--BEGIN_II_LINKS-->
<DIV id="links">
<CENTER>
<FONT size="1" face="geneva, arial, sans-serif">
<STRONG>
<A href="index.html">Interactive Illustrations</A>&nbsp;| 
<A href="http://www.artima.com/insidejvm/resources/">Resources Page</A>&nbsp;| 
<A href="http://www.artima.com/insidejvm/blurb.html">Order the Book</A>&nbsp;| 
<A href="EternalMath.html">Previous</A>&nbsp;| 
<A href="HeapOfFish.html">Next</A>&nbsp; 
</STRONG>
</FONT>
</CENTER>
</DIV>
<!--END_II_LINKS-->


<p>The <i>Getting Loaded</i> applet, included below, simulates a Java virtual machine loading a class file. This applet accompanies Chapter 6, &quot;The Java Class File,&quot; of <i>Inside the Java 2 Virtual Machine</i>.</p>

<p><center><applet CODE="GettingLoaded.class" ARCHIVE="GettingLoaded.jar"
CODEBASE="GettingLoaded" WIDTH=625 HEIGHT=360><param NAME=classURL VALUE="GettingLoaded/Act.class"><param NAME=textURL VALUE="GettingLoaded/ActText.txt"><b>For some reason, your browser won't let you view this way cool Java applet.</b></applet></center></p>

<p>The class file being loaded in the simulation was generated by the <CODE>javac</CODE> compiler from the Java source code shown below. Although the snippet of code used in the simulation may not be very useful in the real world, it does compile to a real class file and provides a reasonably simple example of the class file format. This is the same class used in the <a href="EternalMath.html"><i>Eternal Math</i></a> simulation applet that accompanies Chapter 5, &quot;The Java Virtual Machine.&quot;
<pre>// On CD-ROM in file classfile/ex1/Act.java
class Act {

    public static void doMathForever() {
        int i = 0;
        for (;;) {
            i += 1;
            i *= 2;
        }
    }
}</pre>
</p>
<p>The <i>Getting Loaded</i> applet allows you to drive the class load simulation one step at a time. For each step along the way you can read about the next chunk of bytes that is about to be consumed and interpreted by the Java virtual machine. Just press the Step button to cause the virtual machine to consume the next chunk. Pressing Back will undo the previous step, and pressing Reset will return the simulation to its original state, allowing you to start over from the beginning.
</p>
<p>The Java virtual machine is shown at the bottom left consuming the stream of bytes that makes up the class file <CODE>Act.class</CODE>. The bytes are shown in hex streaming out of a server on the bottom right. The bytes travel right to left, between the server and the Java virtual machine, one chunk at a time. The chunk of bytes to be consumed by the virtual machine on the next Step button press are shown in red. These highlighted bytes are described in the large text area above the Java virtual machine. Any remaining bytes beyond the next chunk are shown in black.
</p>
<p>Many items in the class file refer to constant pool entries. To make it easier for you to look up constant pool entries as you step through the simulation, a list of the contents of <CODE>Act</CODE>'s constant pool is shown here:
</p>

<CENTER>
<TABLE BORDER=1>
<CAPTION align="top"><CENTER><EM><B>Class <CODE>Act</CODE>'s constant pool</B></EM></CENTER>
</CAPTION>
<TR><TH WIDTH=100><CENTER><STRONG>Index</STRONG></CENTER></TH><TH WIDTH=242><CENTER><STRONG>Type</STRONG></CENTER>
</TH><TH WIDTH=242><CENTER><STRONG>Value</STRONG></CENTER>
</TH></TR>

<TR><TD align="center" WIDTH=100><CENTER>1</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Class_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER>7</CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>2</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Class_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER>16<CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>3</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Methodref_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER>2, 4<CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>4</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_NameAndType_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER>6, 5<CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>5</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Utf8_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER><CODE>&quot;()V&quot;</CODE><CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>6</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Utf8_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER><CODE>&quot;&#60;init&#62;&quot; </CODE><CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>7</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Utf8_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER><CODE>&quot;Act&quot;</CODE><CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>8</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Utf8_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER><CODE>&quot;Act.java&quot;</CODE><CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>9</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Utf8_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER><CODE>&quot;Code&quot;</CODE><CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>10</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Utf8_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER><CODE>&quot;ConstantValue&quot;</CODE><CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>11</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Utf8_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER><CODE>&quot;Exceptions&quot;</CODE><CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>12</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Utf8_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER><CODE>&quot;LineNumberTable&quot;</CODE><CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>13</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Utf8_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER><CODE>&quot;LocalVariables&quot;</CODE><CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>14</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Utf8_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER><CODE>&quot;SourceFile&quot;</CODE><CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>15</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Utf8_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER><CODE>&quot;doMathForever&quot;</CODE><CENTER>
</TD></TR>

<TR><TD align="center" WIDTH=100><CENTER>16</CENTER>
</TD><TD align="center" WIDTH=242><CENTER><CODE>CONSTANT_Utf8_info</CODE></CENTER>
</TD><TD WIDTH=242><CENTER><CODE>&quot;java/lang/Object&quot;</CODE><CENTER>
</TD></TR>

</TABLE>
</CENTER>

<p>Each chunk of bytes is fully explained in the text area. Because there is a lot of detail in the text area, you may wish to skim through all the steps first to get the general idea, then look back for more details. Happy clicking.</p>

<p><HR WIDTH=500></p>
<p>
Click here to view a page of links to the <a href="sourcecode.html#GettingLoaded">source code</a> of the <i>Getting Loaded</i> applet.
</p>


<!--BEGIN_II_LINKS-->
<DIV id="links">
<CENTER>
<FONT size="1" face="geneva, arial, sans-serif">
<STRONG>
<A href="index.html">Interactive Illustrations</A>&nbsp;| 
<A href="http://www.artima.com/insidejvm/resources/">Resources Page</A>&nbsp;| 
<A href="http://www.artima.com/insidejvm/blurb.html">Order the Book</A>&nbsp;| 
<A href="EternalMath.html">Previous</A>&nbsp;| 
<A href="HeapOfFish.html">Next</A>&nbsp; 
</STRONG>
</FONT>
</CENTER>
</DIV>
<!--END_II_LINKS-->
<!--END_MAIN_BODY-->
<!--BEGIN_RIGHT_MARGIN_TABLE_CLOSE-->
</TD>
</TR>
</TABLE>
<!--END_RIGHT_MARGIN_TABLE_CLOSE-->
<!--BEGIN_FOOTER_SEPARATOR-->
<HR width="100%">
<!--END_FOOTER_SEPARATOR-->
<!--BEGIN_FOOTER-->
<TABLE width="100%">
<TR>
<TD align="left">
<FONT size="1" face="geneva, arial, sans-serif">
<!--REG_COPYRIGHT_LINE--><A href="copyright.html">Copyright</A> &copy; 1996-1999 Bill Venners. All Rights Reserved.
</FONT>
</TD>
</TR>
</TABLE>
<!--END_FOOTER-->
</body>
</html>
